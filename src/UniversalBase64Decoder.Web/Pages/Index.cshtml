@page
@model IndexModel
@{
    ViewData["Title"] = "Universal Base64 Decoder";
}

<h2>Universal Base64 Decoder</h2>

<form method="post">
    <div>
        <textarea asp-for="InputBase64" rows="8" cols="80"
                  placeholder="Paste base64 string here..."></textarea>
    </div>

    <br />

    <button type="submit">Decode</button>
</form>

@if (Model.Result != null)
{
    <hr />

    <h3>Decoded Output</h3>

    <p><strong>File Type:</strong> @Model.FileType</p>
    <p><strong>Suggested Extension:</strong> @Model.Extension</p>
    <p><strong>Size:</strong> @Model.Size bytes</p>
    @if (Model.RawBase64 != null)
    {
        <p>
            <a download="@Model.DownloadFileName"
               href="data:application/octet-stream;base64,@Model.RawBase64">
                ⬇️ Download decoded file
            </a>
        </p>
    }

    <h4>Preview:</h4>

    @* ================= PRIMARY PREVIEW ================= *@

    @switch (Model.FileType)
    {
        case "PNG Image":
        case "JPEG Image":
            <img src="data:@Model.MimeType;base64,@Model.RawBase64"
                 style="max-width:500px; border:1px solid #ccc;" />
            break;

        case "PDF Document":
            <iframe src="data:@Model.MimeType;base64,@Model.RawBase64"
                    width="600" height="500"
                    style="border:1px solid #ccc;"></iframe>
            break;

        default:
            <pre>@Model.Result</pre>
            break;
    }

    @* ================= ENHANCEMENTS ================= *@

    @* ZPL Rendering Enhancement *@
    @if (Model.RenderedImageBase64 != null)
    {
        <hr />
        <h4>Rendered Label (ZPL)</h4>
        <img src="data:image/png;base64,@Model.RenderedImageBase64"
             style="max-width:500px; border:1px solid #ccc; padding:6px;" />
    }
    @if (Model.RenderedImageBase64 != null)
    {
        <div style="margin-top:10px;">
            <a download="export.png"
               href="data:image/png;base64,@Model.RenderedImageBase64">
                ⬇️ Download as PNG
            </a>
        </div>
    }

    @if (Model.ExportPdfBase64 != null)
    {
        <div>
            <a download="export.pdf"
               href="data:application/pdf;base64,@Model.ExportPdfBase64">
                ⬇️ Download as PDF
            </a>
        </div>
    }
}